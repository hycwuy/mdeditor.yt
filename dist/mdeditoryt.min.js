/*! MdEditor.yt v0.2.0 | mdeditoryt.min.js | Open source online markdown editor. | MIT License | By: Yutuo | https://github.com/yutuo/mdeditor.yt | 2016-06-16 */
!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.MdEditorYt=e()}}(function(){return function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return o(r?r:e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){"use strict";var n,o=jQuery,i={html:!0,xhtmlOut:!0,breaks:!0,linkify:!0,typographer:!1,useAbbr:!0,useContainer:!0,useDeflist:!0,useEmoji:!0,useFootnote:!0,useIns:!0,useMark:!0,useSub:!0,useSup:!0,useToc:!0,useMath:!0,useLinkNewWin:!1,useSourceLine:!0,useCodeBlockPre:!1,highlight:!0,useLineNumber:!0,useShowLangName:!0,editorTheme:"default",tabSize:4,dragDrop:!1,lineNumbers:!0,lineWrapping:!0,autoFocus:!0,autoCloseTags:!0,readOnly:!1,indentUnit:4,matchBrackets:!0,indentWithTabs:!0,styleSelectedText:!0,matchWordHighlight:!0,autoCloseBrackets:!0,showTrailingSpace:!0,scrollPastEnd:!0,value:"",delay:300,searchReplace:!0,syncScrolling:!0,mdValueName:"",htmlValueName:"",onload:function(){},onchange:function(){}},s=function(){};s.mouseOrTouch=function(e,t){e=e||"click",t=t||"touchend";var r=e;try{document.createEvent("TouchEvent"),r=t}catch(n){}return r},s.prototype={options:{},init:function(e,t){this.options=o.extend(!0,i,t),this.options.useSourceLine=this.options.syncScrolling?!0:this.options.useSourceLine,this.editor=o("object"==typeof e?e:"#"+e),this.editor.addClass("MdEditorYt"),this.editor.css({width:"number"==typeof this.options.width?this.options.width+"px":this.options.width,height:"number"==typeof this.options.height?this.options.height+"px":this.options.height}),this.preview=o('<div class="preview"></div>'),this.editor.append(this.preview),this.previewContainer=o('<div class="previewContainer"></div>'),this.preview.append(this.previewContainer),this.mdValue=o('<textarea class="mdValue" name="'+this.options.mdValueName+'"></textarea>'),this.editor.append(this.mdValue),this.htmlValue=o('<textarea class="htmlValue" name="'+this.options.htmlValueName+'"></textarea>'),this.editor.append(this.htmlValue),this.cmContainer=o('<div class="cmContainer"></div>'),this.editor.append(this.cmContainer);var r={mode:"markdown",theme:this.options.editorTheme,tabSize:this.options.tabSize,dragDrop:this.options.dragDrop,autofocus:this.options.autoFocus,autoCloseTags:this.options.autoCloseTags,readOnly:this.options.readOnly?"nocursor":!1,indentUnit:this.options.indentUnit,lineNumbers:this.options.lineNumbers,lineWrapping:this.options.lineWrapping,scrollPastEnd:this.options.scrollPastEnd,value:this.options.value,foldGutter:this.options.codeFold,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],matchBrackets:this.options.matchBrackets,indentWithTabs:this.options.indentWithTabs,styleActiveLine:this.options.styleActiveLine,styleSelectedText:this.options.styleSelectedText,autoCloseBrackets:this.options.autoCloseBrackets,showTrailingSpace:this.options.showTrailingSpace,highlightSelectionMatches:this.options.matchWordHighlight?{showToken:"onselected"===this.options.matchWordHighlight?!1:/\w/}:!1};return this.cmEditor=new CodeMirror(this.cmContainer.get(0),r),this.setTheme(this.options.editorTheme),this.cmEditorDiv=this.cmContainer.find(".CodeMirror"),this.preview.height(this.cmContainer.get(0).offsetHeight),this.markdownYt=new MarkdownYt(this.options),this.save(),this.bindChangeEvent(),this.options.onload(this),this},setTheme:function(e){var t=this.cmEditor.getOption("theme");return this.preview.removeClass("cm-s-"+t).addClass("cm-s-"+e),this.cmEditor.setOption("theme",e),this},bindChangeEvent:function(){var e=this;return this.cmEditor.on("change",function(){n=setTimeout(function(){clearTimeout(n),e.save(),e.cmEditorScroll(e),e.options.onchange(e),n=null},e.options.delay)}),this.bindScrollEvent(),this},save:function(){if(null===n)return this;var e=this.cmEditor.getValue();this.options.mdValueName&&this.mdValue.val(e);var t=this.markdownYt.render(e);this.options.htmlValueName&&this.htmlValue.val(t.replace(/(<\w+[^>]*) data-source-line=(['"])\d+\2([^>]*>)/g,"$1$3"));try{this.previewContainer.html(t);var r=this.previewContainer.children(),o=this.cmContainer.get(0).offsetHeight;r&&(o-=r[r.length-1].offsetHeight),this.previewContainer.css("padding-bottom",o+"px")}catch(i){}},bindScrollEvent:function(){if(this.options.syncScrolling){var e=this,t=function(){e.cmEditorDiv.find(".CodeMirror-scroll").bind("scroll",function(){e.cmEditorScroll(e)})},r=function(){e.cmEditorDiv.find(".CodeMirror-scroll").unbind("scroll")},n=function(){e.preview.bind("scroll",function(){e.previewScroll(e)})},o=function(){e.preview.unbind("scroll")};this.cmEditorDiv.bind({mouseover:t,mouseout:r,touchstart:t,touchend:r}),this.preview.bind({mouseover:n,mouseout:o,touchstart:n,touchend:o})}},previewScroll:function(e){function t(){for(var t=e.preview.scrollTop(),r=!1,o=!1,i=0;i<n.length;i++){if(!(n[i].offsetTop<t)){o=i;break}r=i}var s=0,a=e.previewContainer.outerHeight()-e.preview.outerHeight();r!==!1&&(s=n[r].offsetTop),o!==!1&&(a=n[o].offsetTop);var l=0;return a!==s&&(l=(t-s)/(a-s)),{lastMarker:r,nextMarker:o,percentage:l}}function r(t){var r=[];n.each(function(){r.push(o(this).data("source-line"))});for(var i=[],s=0,a=0;a<r[r.length-1];a++)-1!==o.inArray(a+1,r)&&i.push(s),s+=e.cmEditor.getLineHandle(a).height;var l=0,c=0;if(t.lastMarker!==!1&&(l=i[t.lastMarker]),t.nextMarker!==!1)c=i[t.nextMarker];else for(var a=0;a<e.cmEditor.lineCount();a++)c+=e.cmEditor.getLineHandle(a).height;var u=(c-l)*t.percentage+l;e.cmEditor.scrollTo(0,u)}var n=e.previewContainer.find("[data-source-line]");r(t())},cmEditorScroll:function(e){function t(){var t=[];n.each(function(){t.push(o(this).data("source-line"))});for(var r=[],i=0,s=0;s<t[t.length-1];s++)-1!==o.inArray(s+1,t)&&r.push(i),i+=e.cmEditor.getLineHandle(s).height;for(var a=e.cmEditor.getScrollInfo().top,l=!1,c=!1,s=0;s<r.length;s++){if(!(r[s]<a)){c=s;break}l=s}var u=0,p=0;if(l!==!1&&(u=r[l]),c!==!1)p=r[c];else for(var s=0;s<e.cmEditor.lineCount();s++)p+=e.cmEditor.getLineHandle(s).height;var f=0;return p!==u&&(f=(a-u)/(p-u)),{lastMarker:t[l],nextMarker:t[c],percentage:f}}function r(t){var r=0,n=e.previewContainer.outerHeight()-e.preview.outerHeight();void 0!==t.lastMarker&&(r=e.previewContainer.find('>[data-source-line="'+t.lastMarker+'"]').get(0).offsetTop),void 0!==t.nextMarker&&(n=e.previewContainer.find('>[data-source-line="'+t.nextMarker+'"]').get(0).offsetTop);var o=r+(n-r)*t.percentage;e.preview.scrollTop(o)}var n=e.previewContainer.find("[data-source-line]");r(t())}},t.exports=function(e,t){var r=new s;return r.init(e,t),r}},{}]},{},[1])(1)});